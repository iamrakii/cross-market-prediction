<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cross-Market Volatility Prediction</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }
        
        header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px 20px;
            text-align: center;
        }
        
        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        header p {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        nav {
            background: #f8f9fa;
            display: flex;
            flex-wrap: wrap;
            border-bottom: 2px solid #e9ecef;
        }
        
        nav button {
            flex: 1;
            padding: 15px 20px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1em;
            color: #495057;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
            min-width: 120px;
        }
        
        nav button:hover {
            background: #e9ecef;
            color: #667eea;
        }
        
        nav button.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: #f0f4ff;
        }
        
        .content {
            padding: 40px;
            min-height: 600px;
        }
        
        .section {
            display: none;
            animation: fadeIn 0.3s;
        }
        
        .section.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        h2 {
            color: #667eea;
            margin-bottom: 30px;
            font-size: 2em;
            border-bottom: 3px solid #667eea;
            padding-bottom: 15px;
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }
        
        .card h3 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .card label {
            display: block;
            margin-bottom: 8px;
            color: #495057;
            font-weight: 500;
        }
        
        select, input {
            width: 100%;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            font-size: 1em;
        }
        
        select:focus, input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 5px rgba(102, 126, 234, 0.3);
        }
        
        button.btn {
            background: #667eea;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s;
        }
        
        button.btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin: 30px 0;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .metrics {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .metric {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
        }
        
        .metric h4 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }
        
        .metric .value {
            font-size: 1.8em;
            font-weight: bold;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        table th {
            background: #667eea;
            color: white;
            padding: 15px;
            text-align: left;
        }
        
        table td {
            padding: 12px 15px;
            border-bottom: 1px solid #dee2e6;
        }
        
        table tr:hover {
            background: #f8f9fa;
        }
        
        .heatmap {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            overflow-x: auto;
        }
        
        .heatmap-table {
            width: 100%;
            min-width: 600px;
            border-collapse: collapse;
        }
        
        .heatmap-table td {
            padding: 10px;
            text-align: center;
            font-weight: bold;
            font-size: 0.9em;
        }
        
        .heatmap-value {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            color: white;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #667eea;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .footer {
            background: #f8f9fa;
            padding: 20px;
            text-align: center;
            color: #6c757d;
            border-top: 1px solid #dee2e6;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .grid {
                grid-template-columns: 1fr;
            }
            
            nav button {
                flex: auto;
            }
            
            header h1 {
                font-size: 1.5em;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìä Cross-Market Volatility Prediction</h1>
            <p>Analyzing global stock indices using Graph Neural Networks</p>
        </header>
        
        <nav>
            <button class="nav-btn active" data-section="home">üè† Home</button>
            <button class="nav-btn" data-section="analysis">üìà Data Analysis</button>
            <button class="nav-btn" data-section="statistics">üìä Statistics</button>
            <button class="nav-btn" data-section="correlations">üîó Correlations</button>
            <button class="nav-btn" data-section="models">ü§ñ Models</button>
            <button class="nav-btn" data-section="about">üìã About</button>
        </nav>
        
        <div class="content">
            <!-- Home Section -->
            <div id="home" class="section active">
                <h2>Welcome to the Dashboard</h2>
                <p style="font-size: 1.1em; color: #495057; margin-bottom: 30px;">
                    This interactive web application demonstrates a <strong>Cross-Market Volatility Prediction System</strong> 
                    that analyzes global stock indices using advanced neural network architectures.
                </p>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px;">
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 15px;">Key Features:</h3>
                        <ul style="line-height: 2; color: #495057;">
                            <li>üìä Real-time Data Analysis of 8 global stock indices</li>
                            <li>üìà Volatility Calculation using 21-day rolling windows</li>
                            <li>üîó Correlation Analysis to understand market relationships</li>
                            <li>ü§ñ Neural Network Models (GCN + GAT architectures)</li>
                            <li>üìã Comprehensive Metrics (MAPE, RMSE, MSE, MAFE)</li>
                        </ul>
                    </div>
                    <div>
                        <h3 style="color: #667eea; margin-bottom: 15px;">Stock Indices Analyzed:</h3>
                        <ul style="line-height: 2; color: #495057;">
                            <li>üá∫üá∏ S&P 500 (^GSPC)</li>
                            <li>üá©üá™ DAX (^GDAXI)</li>
                            <li>üá´üá∑ CAC 40 (^FCHI)</li>
                            <li>üá¨üáß FTSE 100 (^FTSE)</li>
                            <li>üáÆüá≥ Nifty 50 (^NSEI)</li>
                            <li>üáØüáµ Nikkei 225 (^N225)</li>
                            <li>üá∞üá∑ KOSPI (^KS11)</li>
                            <li>üá≠üá∞ Hang Seng (^HSI)</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Data Analysis Section -->
            <div id="analysis" class="section">
                <h2>Data Analysis</h2>
                
                <div class="card">
                    <h3>Select Ticker</h3>
                    <label>Choose a stock index:</label>
                    <select id="tickerSelect">
                        {% for ticker in tickers %}
                        <option value="{{ ticker }}">{{ ticker }}</option>
                        {% endfor %}
                    </select>
                    <button class="btn" onclick="loadAnalysis()">Load Data</button>
                </div>
                
                <div id="analysisMetrics" class="metrics" style="display: none;">
                    <div class="metric">
                        <h4>Mean Volatility</h4>
                        <div class="value" id="meanVol">-</div>
                    </div>
                    <div class="metric">
                        <h4>Std Deviation</h4>
                        <div class="value" id="stdVol">-</div>
                    </div>
                    <div class="metric">
                        <h4>Data Points</h4>
                        <div class="value" id="dataPoints">-</div>
                    </div>
                </div>
                
                <h3 style="color: #667eea; margin-top: 40px;">Realized Volatility</h3>
                <div class="chart-container">
                    <canvas id="volatilityChart"></canvas>
                </div>
                
                <h3 style="color: #667eea; margin-top: 40px;">Close Prices</h3>
                <div class="chart-container">
                    <canvas id="priceChart"></canvas>
                </div>
            </div>
            
            <!-- Statistics Section -->
            <div id="statistics" class="section">
                <h2>Descriptive Statistics</h2>
                
                <table id="statsTable">
                    <thead>
                        <tr>
                            <th>Ticker</th>
                            <th>Mean</th>
                            <th>Std Dev</th>
                            <th>Min</th>
                            <th>Max</th>
                            <th>Data Points</th>
                        </tr>
                    </thead>
                    <tbody id="statsBody">
                        <tr><td colspan="6" class="loading">Loading statistics...</td></tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Correlations Section -->
            <div id="correlations" class="section">
                <h2>Cross-Market Correlations</h2>
                
                <p style="color: #495057; margin-bottom: 20px;">
                    Correlation matrix showing volatility spillover effects between indices
                </p>
                
                <div class="heatmap" id="heatmapContainer">
                    <div class="loading"><div class="spinner"></div>Loading correlation matrix...</div>
                </div>
            </div>
            
            <!-- Models Section -->
            <div id="models" class="section">
                <h2>Neural Network Models</h2>
                
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; margin-bottom: 40px;">
                    <div class="card" style="background: linear-gradient(135deg, rgba(102,126,234,0.1) 0%, rgba(118,75,162,0.1) 100%);">
                        <h3>üìä GCN + GAT Model</h3>
                        <p style="color: #495057; line-height: 1.8;">
                            <strong>Architecture:</strong><br>
                            ‚Ä¢ Graph Convolutional Network (GCN) layers<br>
                            ‚Ä¢ Graph Attention Network (GAT) layers<br>
                            ‚Ä¢ Hybrid approach for market structure learning<br><br>
                            <strong>Features:</strong><br>
                            ‚Ä¢ Learns market topology from data<br>
                            ‚Ä¢ Attention mechanism for edge importance<br>
                            ‚Ä¢ 50 epochs training<br>
                            ‚Ä¢ Dropout regularization
                        </p>
                    </div>
                    
                    <div class="card" style="background: linear-gradient(135deg, rgba(102,126,234,0.1) 0%, rgba(118,75,162,0.1) 100%);">
                        <h3>üìà Baseline MLP Model</h3>
                        <p style="color: #495057; line-height: 1.8;">
                            <strong>Architecture:</strong><br>
                            ‚Ä¢ 3 Fully Connected Layers<br>
                            ‚Ä¢ ReLU activation functions<br>
                            ‚Ä¢ Dropout regularization<br><br>
                            <strong>Features:</strong><br>
                            ‚Ä¢ Simple benchmark model<br>
                            ‚Ä¢ Fast training<br>
                            ‚Ä¢ Good baseline performance<br>
                            ‚Ä¢ Easy to interpret
                        </p>
                    </div>
                </div>
                
                <h3 style="color: #667eea;">Prediction Metrics</h3>
                <table>
                    <tr>
                        <th style="background: #667eea; color: white;">Metric</th>
                        <th style="background: #667eea; color: white;">Definition</th>
                    </tr>
                    <tr>
                        <td><strong>MAFE</strong></td>
                        <td>Mean Absolute Forecast Error</td>
                    </tr>
                    <tr>
                        <td><strong>MSE</strong></td>
                        <td>Mean Squared Error</td>
                    </tr>
                    <tr>
                        <td><strong>RMSE</strong></td>
                        <td>Root Mean Squared Error</td>
                    </tr>
                    <tr>
                        <td><strong>MAPE</strong></td>
                        <td>Mean Absolute Percentage Error</td>
                    </tr>
                </table>
                
                <h3 style="color: #667eea; margin-top: 30px;">Model Performance (Sample Results)</h3>
                <div class="chart-container">
                    <canvas id="performanceChart"></canvas>
                </div>
            </div>
            
            <!-- About Section -->
            <div id="about" class="section">
                <h2>About This Project</h2>
                
                <h3 style="color: #667eea; margin: 30px 0 15px 0;">Cross-Market Prediction Using Dynamic Neural Network</h3>
                
                <div style="color: #495057; line-height: 1.8;">
                    <h4 style="color: #667eea; margin-top: 20px;">Overview</h4>
                    <p>This project develops a sophisticated forecasting system for global market volatility using advanced machine learning techniques, specifically Graph Neural Networks.</p>
                    
                    <h4 style="color: #667eea; margin-top: 20px;">Research Focus</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Volatility Spillover:</strong> Understanding how shocks in one market affect others</li>
                        <li><strong>Graph-based Learning:</strong> Using network structure to improve predictions</li>
                        <li><strong>Attention Mechanisms:</strong> Learning which market relationships matter most</li>
                    </ul>
                    
                    <h4 style="color: #667eea; margin-top: 20px;">Data</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Time Period:</strong> 2007-2022 (15 years of historical data)</li>
                        <li><strong>Indices:</strong> 8 major global stock market indices</li>
                        <li><strong>Frequency:</strong> Daily trading data</li>
                        <li><strong>Preprocessing:</strong> Forward-fill missing values, aligned to business days</li>
                    </ul>
                    
                    <h4 style="color: #667eea; margin-top: 20px;">Technologies Used</h4>
                    <ul style="margin-left: 20px;">
                        <li><strong>Flask:</strong> Web framework</li>
                        <li><strong>Chart.js:</strong> Interactive visualizations</li>
                        <li><strong>Python:</strong> Data processing and calculations</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="footer">
            <p>¬© 2025 Cross-Market Prediction Project | Built with Flask & Chart.js | Updated: December 2, 2025</p>
        </div>
    </div>
    
    <script>
        let volatilityChart = null;
        let priceChart = null;
        let performanceChart = null;
        
        // Navigation
        document.querySelectorAll('.nav-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
                document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                
                btn.classList.add('active');
                document.getElementById(btn.dataset.section).classList.add('active');
                
                // Load data when entering statistics or correlations
                if (btn.dataset.section === 'statistics') loadStatistics();
                if (btn.dataset.section === 'correlations') loadCorrelations();
                if (btn.dataset.section === 'models') loadPerformanceChart();
            });
        });
        
        // Load analysis data
        function loadAnalysis() {
            const ticker = document.getElementById('tickerSelect').value;
            
            Promise.all([
                fetch(`/api/volatility/${ticker}`).then(r => r.json()),
                fetch(`/api/prices/${ticker}`).then(r => r.json())
            ]).then(([volData, priceData]) => {
                // Update metrics
                document.getElementById('analysisMetrics').style.display = 'grid';
                document.getElementById('meanVol').textContent = volData.mean.toFixed(6);
                document.getElementById('stdVol').textContent = volData.std.toFixed(6);
                document.getElementById('dataPoints').textContent = volData.dataPoints;
                
                // Update volatility chart
                if (volatilityChart) volatilityChart.destroy();
                const volCtx = document.getElementById('volatilityChart').getContext('2d');
                volatilityChart = new Chart(volCtx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: volData.volatility.length}, (_, i) => i),
                        datasets: [{
                            label: 'Realized Volatility',
                            data: volData.volatility,
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                labels: { color: '#495057' }
                            }
                        },
                        scales: {
                            y: { ticks: { color: '#495057' } },
                            x: { ticks: { color: '#495057' } }
                        }
                    }
                });
                
                // Update price chart
                if (priceChart) priceChart.destroy();
                const priceCtx = document.getElementById('priceChart').getContext('2d');
                priceChart = new Chart(priceCtx, {
                    type: 'line',
                    data: {
                        labels: Array.from({length: priceData.prices.length}, (_, i) => i),
                        datasets: [{
                            label: 'Close Price',
                            data: priceData.prices,
                            borderColor: '#764ba2',
                            backgroundColor: 'rgba(118, 75, 162, 0.1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: true,
                                labels: { color: '#495057' }
                            }
                        },
                        scales: {
                            y: { ticks: { color: '#495057' } },
                            x: { ticks: { color: '#495057' } }
                        }
                    }
                });
            }).catch(err => console.error('Error loading analysis:', err));
        }
        
        // Load statistics
        function loadStatistics() {
            fetch('/api/statistics')
                .then(r => r.json())
                .then(data => {
                    const tbody = document.getElementById('statsBody');
                    tbody.innerHTML = data.map(row => `
                        <tr>
                            <td><strong>${row.ticker}</strong></td>
                            <td>${row.mean}</td>
                            <td>${row.std}</td>
                            <td>${row.min}</td>
                            <td>${row.max}</td>
                            <td>${row.dataPoints}</td>
                        </tr>
                    `).join('');
                });
        }
        
        // Load correlations
        function loadCorrelations() {
            fetch('/api/correlations')
                .then(r => r.json())
                .then(data => {
                    const container = document.getElementById('heatmapContainer');
                    const tickers = data.tickers;
                    const matrix = data.matrix;
                    
                    let html = '<table class="heatmap-table"><tr><td></td>';
                    tickers.forEach(t => html += `<td><strong>${t}</strong></td>`);
                    html += '</tr>';
                    
                    matrix.forEach((row, i) => {
                        html += `<tr><td><strong>${tickers[i]}</strong></td>`;
                        row.forEach(val => {
                            const intensity = Math.abs(val);
                            const hue = val > 0 ? 0 : 10;
                            const color = `hsl(${hue}, 70%, ${100 - intensity * 40}%)`;
                            html += `<td><div class="heatmap-value" style="background: ${color};">${val.toFixed(2)}</div></td>`;
                        });
                        html += '</tr>';
                    });
                    html += '</table>';
                    
                    container.innerHTML = html;
                });
        }
        
        // Load performance chart
        function loadPerformanceChart() {
            if (performanceChart) return;
            
            const ctx = document.getElementById('performanceChart');
            if (!ctx) return;
            
            performanceChart = new Chart(ctx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['1-day', '5-day', '10-day', '22-day'],
                    datasets: [
                        {
                            label: 'GCN + GAT RMSE',
                            data: [0.0234, 0.0412, 0.0621, 0.0845],
                            borderColor: '#667eea',
                            backgroundColor: 'rgba(102, 126, 234, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 6,
                            pointBackgroundColor: '#667eea'
                        },
                        {
                            label: 'Baseline MLP RMSE',
                            data: [0.0285, 0.0502, 0.0745, 0.0921],
                            borderColor: '#764ba2',
                            backgroundColor: 'rgba(118, 75, 162, 0.1)',
                            borderWidth: 3,
                            tension: 0.4,
                            fill: true,
                            pointRadius: 6,
                            pointBackgroundColor: '#764ba2'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: true,
                            labels: { color: '#495057' }
                        }
                    },
                    scales: {
                        y: { ticks: { color: '#495057' } },
                        x: { ticks: { color: '#495057' } }
                    }
                }
            });
        }
        
        // Load initial data
        loadAnalysis();
    </script>
</body>
</html>
